# 睡眠リテラシーテスト仕様書

## 概要

オンボーディング完了時に実施する睡眠リテラシーテストの仕様を定義します。このテストは、ユーザーの睡眠に関する知識レベルを測定し、データ分析による睡眠行動パターンの理解と改善を目的としています。

## 基本仕様

### テスト構成
- **問題数**: 全10問
- **選択肢**: 4択 + 「分からない」の計5つの選択肢
- **採点方法**: 
  - 正解: 1ポイント
  - 不正解・分からない: 0ポイント
  - 最大スコア: 10ポイント
- **制限時間**: なし（ユーザーのペースで回答可能）
- **回答の変更**: 次の問題に進む前まで変更可能

### スコアの保存
- ユーザープロファイルに「睡眠リテラシースコア」として保存
- 初回テスト実施日時も記録
- 将来的なリテストによる成長度測定に対応

## UI/UXガイドライン

### デザイン原則
1. **シンプルさ最優先**
   - 余計な装飾を排除
   - 質問と選択肢に集中できるレイアウト
   - 十分な余白とフォントサイズ

2. **ストレスフリーな操作**
   - 1画面1問形式
   - 大きくタップしやすい選択肢ボタン
   - 誤タップしても即座に次へ進まない（確認ステップ）
   - スワイプでの前後移動サポート

3. **進捗の可視化**
   - 上部に進捗バー（10段階）
   - 現在の問題番号表示（例: 3/10）
   - 残り問題数の明示

4. **心理的安全性の確保**
   - 「正解/不正解」の即時フィードバックなし
   - プレッシャーを与えない柔らかい表現
   - 「分からない」選択の推奨文言

### 画面構成

#### テスト開始画面
```
睡眠リテラシーチェック

これから睡眠に関する知識を確認する
簡単なテストを行います。

【お願い】
分からない問題は推測せず、
素直に「分からない」を選んでください。
正確な回答が研究データの
品質向上につながります。

全10問・約3-5分

[テストを始める]
```

#### 質問画面
```
[進捗バー: ■■■□□□□□□□] 3/10

Q3. 理想的な睡眠時間について

成人の理想的な睡眠時間は
一般的に何時間とされていますか？

○ 5-6時間
○ 7-9時間
○ 10-12時間
○ 人により大きく異なる
○ 分からない

[前の問題] [次へ]
```

#### 結果画面
```
テスト完了！

あなたの睡眠リテラシースコア
[7/10]

睡眠の基礎知識をお持ちですね！
このアプリを使いながら、
さらに睡眠の質を高めていきましょう。

[結果の詳細を見る] [ホームへ進む]
```

## 質問カテゴリーと内容

### カテゴリー分類（各2-3問）

1. **睡眠の基礎知識**
   - 睡眠時間、睡眠サイクル、レム睡眠・ノンレム睡眠

2. **睡眠の誤解と真実**
   - 一般的な睡眠神話の真偽判定

3. **睡眠衛生**
   - 良質な睡眠のための生活習慣

4. **睡眠と健康**
   - 睡眠不足の影響、睡眠と病気の関係

5. **個人差の理解**
   - クロノタイプ、年齢による変化

### 質問例

#### Q1. 睡眠サイクル（基礎知識）
```
一晩の睡眠中、レム睡眠とノンレム睡眠の
サイクルは約何分で繰り返されますか？

1. 約30分
2. 約60分
3. 約90分 [正解]
4. 約120分
5. 分からない
```

#### Q2. 睡眠負債（誤解と真実）
```
平日の睡眠不足は週末の寝だめで
完全に解消できる。この説明は？

1. 完全に正しい
2. ある程度正しい
3. ほとんど正しくない [正解]
4. 個人差が大きい
5. 分からない
```

#### Q3. ブルーライト（睡眠衛生）
```
就寝前のスマートフォン使用が
睡眠に与える主な悪影響は？

1. 電磁波による脳への影響
2. ブルーライトによるメラトニン分泌抑制 [正解]
3. 目の疲れによる入眠困難
4. 通知音による睡眠中断
5. 分からない
```

## 実装詳細

### データモデル
```dart
class SleepLiteracyTest {
  final List<Question> questions;
  final int currentIndex;
  final Map<int, int> answers; // 問題ID -> 選択肢番号
  final DateTime startTime;
  
  int get score => // 正解数の計算
  bool get isCompleted => currentIndex >= questions.length;
}

class Question {
  final int id;
  final String category;
  final String questionText;
  final List<String> options;
  final int correctAnswer;
  final String explanation; // 結果画面で表示
}
```

### 画面遷移
1. オンボーディング完了画面
2. テスト開始説明画面
3. 質問画面（10画面）
4. 結果サマリー画面
5. （オプション）詳細結果画面
6. ホーム画面

### アナリティクス
- テスト開始・完了イベント
- 各質問の回答時間
- 「分からない」選択率
- スコア分布
- 離脱率（どの問題で離脱したか）

## 結果の活用

### スコアレベル別対応

#### 初級（0-3点）
- 基礎的な睡眠知識コンテンツを優先表示
- より詳細なガイダンスとヒント
- 睡眠の重要性を伝える教育的コンテンツ

#### 中級（4-7点）
- 標準的なアプリ機能の提供
- 実践的な睡眠改善テクニックの紹介
- 個別の課題に応じたアドバイス

#### 上級（8-10点）
- 詳細な分析機能の開放
- 高度な睡眠改善手法の提案
- コミュニティ機能での知識共有促進

### パーソナライゼーション
- 間違えた分野の補強コンテンツ表示
- リテラシーレベルに応じた用語説明の調整
- 改善提案の複雑さ調整

## 今後の拡張性

### バージョン2.0での機能追加案
1. **カテゴリー別スコア表示**
   - 各分野の理解度を可視化
   - 弱点分野の特定と改善提案

2. **定期的なリテスト**
   - 3ヶ月後、6ヶ月後の成長度測定
   - 新しい問題セットの追加

3. **難易度調整**
   - アダプティブテスト方式
   - 回答に応じて問題難易度を動的調整

4. **解説モード**
   - テスト後に各問題の詳細解説
   - 関連する睡眠知識の提供

## アクセシビリティ配慮

- 十分なコントラスト比の確保
- 読み上げ機能対応
- 文字サイズの調整オプション
- 色覚多様性への配慮（色だけに依存しない）

## 開発上の注意点

1. **離脱防止**
   - 途中保存機能の実装
   - 「後で続ける」オプション
   - プログレスの永続化

2. **エラーハンドリング**
   - ネットワークエラー時のオフライン対応
   - 回答データの確実な保存

3. **パフォーマンス**
   - 質問の先読み込み
   - スムーズな画面遷移
   - 最小限のアニメーション

## 成功指標

- テスト完了率: 90%以上
- 平均回答時間: 3-5分
- 「分からない」選択率: 10-30%（正直な回答の指標）
- ユーザー満足度: 4.0/5.0以上